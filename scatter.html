<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Scatter Chart</title>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
  <div id="chart_div" style="width:800px; height:500px;"></div>

  <script>
    google.charts.load('current', { packages: ['corechart'] });
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
      // 修改為你的 Spreadsheet ID 和 Sheet 名稱
      const spreadsheetId = '1A6OllbUHCiVlk_gbyYRW2JkNIGpuqvv8oRGsTT-Nh0w';
      const sheetName = '泛用輸出'; 

      const query = new google.visualization.Query(
        `https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?sheet=${sheetName}&range=B1:F`
      );

      query.send(handleQueryResponse);
    }

    function handleQueryResponse(response) {
      if (response.isError()) {
        console.error('Error in query: ' + response.getMessage());
        return;
      }

      const data = response.getDataTable();

      // ✅ 檢查是否成功讀取資料
      console.log(data.toJSON());

      // DataView 設定 tooltip 和 X/Y 欄位
      const view = new google.visualization.DataView(data);
      view.setColumns([
        1, // X 軸 (C欄)
        2, { type: 'string', role: 'tooltip', calc: (dt, row) => `${dt.getValue(row,0)}` }, // D欄 + tooltip
        3, { type: 'string', role: 'tooltip', calc: (dt, row) => `${dt.getValue(row,0)}` }, // E欄 + tooltip
        4, { type: 'string', role: 'tooltip', calc: (dt, row) => `${dt.getValue(row,0)}` }  // F欄 + tooltip
      ]);

      const options = {
        title: 'Scatter Plot',
        hAxis: { title: 'X' },
        vAxis: { title: 'Y' },
        legend: { position: 'right' }
      };

      const chart = new google.visualization.ScatterChart(
        document.getElementById('chart_div')
      );
      chart.draw(view, options);
    }
  </script>
</body>
</html>


